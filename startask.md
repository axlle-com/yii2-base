1. Балансировщик нагрузки:
```
Распределяет входящий трафик на серверы, которые обрабатывают запросы по сокращенным ссылкам.
Балансировщик помогает масштабировать приложение, поддерживая обработку высоких нагрузок и обеспечивая высокую доступность.
Он перенаправляет запросы на доступные инстансы для создания новых ссылок и регистрации переходов.
```
2. Сервис генерации ссылок
```
Принимает запросы на генерацию коротких ссылок и отвечает сокращенным URL. Каждый URL имеет уникальный токен, связанный с оригинальной ссылкой.
Отправляет данные по каждому запросу в Kafka для дальнейшей обработки.
```
3. Брокер
```
Обеспечивает устойчивую очередь сообщений для передачи информации о переходах и взаимодействий с ссылками между сервисами.
Kafka действует как буфер между сервером, принимающим переходы по ссылкам, и сервисом статистики, позволяя разгрузить основной сервис от записи переходов напрямую в ClickHouse.
Kafka также может поддерживать репликацию и распределение данных для масштабирования обработки событий.
```
4. Сервис статистики
```
Обрабатывает сообщения из Kafka и записывает статистику по переходам в ClickHouse.
Агрегация данных: Для получения статистики по дням, можно создать периодическую задачу, которая будет агрегировать данные из таблицы url_stats и сохранять их в таблице url_daily_stats
```
